# M2+ AccelMotion (на русском)

Дашборд для визуализации данных акселерометра и телеметрии в реальном времени для MacBook на базе Apple Silicon (M2, M3, M4). Этот проект использует недокументированный встроенный акселерометр для управления интерфейсом в стиле "Liquid Glass".

---

## Как запустить

### Предварительные условия

- Мак с процессором Apple Silicon (M2, M3 или M4).
- Установленный [Go](https://go.dev/doc/install).

### Запуск программы

1. Склонируйте репозиторий и перейдите в его папку.
2. Выполните следующую команду в терминале:

   ```bash
   sudo go run main.go
   ```

> [!IMPORTANT]
> **Почему `sudo`?** macOS ограничивает доступ к низкоуровневому оборудованию (IOKit HID) в целях безопасности. Так как акселерометр в MacBook является недокументированным HID-устройством, программе требуются права суперпользователя (`sudo`) для прямого чтения данных с сенсора. Без этого система просто не даст доступа к данным о движении.

1. Откройте браузер и перейдите по адресу: `http://localhost:8080`

---

## Техническая архитектура

### Ядро (Обработка акселерометра)

Основная логика находится в файле **[`main.go`](/M2+AccelMotion/main.go)**.

Этот файл отвечает за самую сложную часть:

- **Доступ к IOKit HID**: Взаимодействие с акселерометром через специальные Go-биндинги.
- **Сглаживание сигнала**: Использование экспоненциального скользящего среднего (EMA) и фильтров низких частот для устранения "шума" сенсора.
- **Детектор ударов**: Цикл опроса с высокой частотой (50 Гц) отслеживает скачки перегрузки (G-force) для обнаружения физических постукиваний по корпусу макбука.
- **SSE Поток**: Трансляция обработанных данных на фронтенд через Server-Sent Events (SSE).

### Модульный фронтенд

Интерфейс разделен на части для удобства:

- **`js/config.js`**: Централизованные настройки (наклон 3D модели, порог удара, инверсия координат).
- **`js/audio.js`**: Детектор столкновений и загрузка/воспроизведение локальных звуков.
- **`js/visuals.js`**: Вращение 3D модели макбука и "живой" параллакс-фон.
- **`js/chart.js`**: Отрисовка графиков телеметрии на Canvas.

---

## Возможности

- **3D MacBook Live View**: Отслеживание ориентации мака в реальном времени со сглаживанием.
- **Фон Liquid Motion**: Динамические сферы, которые реагируют на наклон устройства.
- **Звук при ударе**: Можно загрузить свой аудиофайл, который будет проигрываться, если постучать по макбуку.
- **Уровень (Spirit Level)**: Пузырьковый уровень для проверки ровности поверхностей.
- **Телеметрия**: Графики перегрузок (G-force) с настройкой масштаба и окна просмотра.

---

## Лицензия

Этот проект распространяется под лицензией **MIT** — вы можете свободно использовать, изменять и распространять его как хотите!
